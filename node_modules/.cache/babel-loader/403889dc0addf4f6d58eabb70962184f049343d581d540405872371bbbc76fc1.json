{"ast":null,"code":"var _jsxFileName = \"E:\\\\BizTecno\\\\slide-fe-service\\\\src\\\\components\\\\Download\\\\DownLoadLink.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, Fragment, useRef } from \"react\";\nimport CustomButton from \"components/CustomButton/CustomButton\";\nimport { fetchRequest, getFullUrl } from \"Api\";\nimport { getBaseUrl, getToken } from \"store/selectors\";\nimport { toast } from \"react-toastify\";\nimport { useSelector } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DownloadLink = ({\n  urlParams,\n  fileName,\n  url,\n  body\n}) => {\n  _s();\n  const downloadRef = useRef(null);\n  const [fetching, setFetching] = useState(false);\n  const token = useSelector(getToken);\n  const baseUrl = useSelector(getBaseUrl);\n  const headers = new Headers();\n  headers.append(\"Authorization\", `${token}`);\n  const handleDownload = async () => {\n    if (!fetching) {\n      try {\n        setFetching(true);\n        const response = await fetchRequest(getFullUrl(baseUrl, url, {\n          urlParams\n        }), token, \"post\", body, headers);\n        const blob = await response.blob();\n        const urlLink = URL.createObjectURL(blob);\n        if (downloadRef.current) {\n          downloadRef.current.href = urlLink;\n          downloadRef.current.download = `${fileName}.csv`;\n          downloadRef.current.click();\n        }\n        setFetching(false);\n      } catch (error) {\n        setFetching(false);\n        toast.error(error.message);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"a\", {\n      ref: downloadRef,\n      className: \"display-none\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CustomButton, {\n      gradientButton: true,\n      type: \"button\",\n      handleClick: handleDownload,\n      buttonText: \"Download\",\n      loading: fetching,\n      baseclassname: \"cursor-pointer margin-r-4\",\n      disabled: !fileName\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n_s(DownloadLink, \"WhhzBTeakpkM3z0OqZYt0auyVDw=\", false, function () {\n  return [useSelector, useSelector];\n});\n_c = DownloadLink;\nexport default DownloadLink;\nvar _c;\n$RefreshReg$(_c, \"DownloadLink\");","map":{"version":3,"names":["React","useState","Fragment","useRef","CustomButton","fetchRequest","getFullUrl","getBaseUrl","getToken","toast","useSelector","jsxDEV","_jsxDEV","DownloadLink","urlParams","fileName","url","body","_s","downloadRef","fetching","setFetching","token","baseUrl","headers","Headers","append","handleDownload","response","blob","urlLink","URL","createObjectURL","current","href","download","click","error","message","children","ref","className","_jsxFileName","lineNumber","columnNumber","gradientButton","type","handleClick","buttonText","loading","baseclassname","disabled","_c","$RefreshReg$"],"sources":["E:/BizTecno/slide-fe-service/src/components/Download/DownLoadLink.tsx"],"sourcesContent":["import React, { useState, Fragment, MutableRefObject, useRef } from \"react\";\nimport CustomButton from \"components/CustomButton/CustomButton\";\nimport { fetchRequest, getFullUrl } from \"Api\";\nimport { getBaseUrl, getToken } from \"store/selectors\";\n\nimport { toast } from \"react-toastify\";\nimport { useSelector } from \"react-redux\";\n\nexport interface DownloadLinkProps {\n  urlParams?: any;\n  queryParams?: any;\n  fileName: string;\n  url: string;\n  body: any;\n}\n\nconst DownloadLink: React.FC<DownloadLinkProps> = ({\n  urlParams,\n  fileName,\n  url,\n  body,\n}) => {\n  const downloadRef: MutableRefObject<HTMLAnchorElement> = useRef(null!);\n\n  const [fetching, setFetching] = useState<boolean>(false);\n  const token = useSelector(getToken);\n  const baseUrl = useSelector(getBaseUrl);\n  const headers = new Headers();\n  headers.append(\"Authorization\", `${token}`);\n  const handleDownload = async () => {\n    if (!fetching) {\n      try {\n        setFetching(true);\n\n        const response = await fetchRequest(\n          getFullUrl(baseUrl, url, { urlParams }),\n          token,\n          \"post\",\n          body,\n          headers\n        );\n        const blob = await response.blob();\n        const urlLink = URL.createObjectURL(blob);\n\n        if (downloadRef.current) {\n          downloadRef.current.href = urlLink;\n          downloadRef.current.download = `${fileName}.csv`;\n          downloadRef.current.click();\n        }\n\n        setFetching(false);\n      } catch (error: any) {\n        setFetching(false);\n        toast.error(error.message);\n      }\n    }\n  };\n\n  return (\n    <Fragment>\n      <a ref={downloadRef} className=\"display-none\" />\n\n      <CustomButton\n        gradientButton\n        type=\"button\"\n        handleClick={handleDownload}\n        buttonText=\"Download\"\n        loading={fetching}\n        baseclassname={\"cursor-pointer margin-r-4\"}\n        disabled={!fileName}\n      />\n    </Fragment>\n  );\n};\n\nexport default DownloadLink;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,QAAQ,EAAoBC,MAAM,QAAQ,OAAO;AAC3E,OAAOC,YAAY,MAAM,sCAAsC;AAC/D,SAASC,YAAY,EAAEC,UAAU,QAAQ,KAAK;AAC9C,SAASC,UAAU,EAAEC,QAAQ,QAAQ,iBAAiB;AAEtD,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAASC,WAAW,QAAQ,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAU1C,MAAMC,YAAyC,GAAGA,CAAC;EACjDC,SAAS;EACTC,QAAQ;EACRC,GAAG;EACHC;AACF,CAAC,KAAK;EAAAC,EAAA;EACJ,MAAMC,WAAgD,GAAGhB,MAAM,CAAC,IAAK,CAAC;EAEtE,MAAM,CAACiB,QAAQ,EAAEC,WAAW,CAAC,GAAGpB,QAAQ,CAAU,KAAK,CAAC;EACxD,MAAMqB,KAAK,GAAGZ,WAAW,CAACF,QAAQ,CAAC;EACnC,MAAMe,OAAO,GAAGb,WAAW,CAACH,UAAU,CAAC;EACvC,MAAMiB,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAC;EAC7BD,OAAO,CAACE,MAAM,CAAC,eAAe,EAAG,GAAEJ,KAAM,EAAC,CAAC;EAC3C,MAAMK,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI,CAACP,QAAQ,EAAE;MACb,IAAI;QACFC,WAAW,CAAC,IAAI,CAAC;QAEjB,MAAMO,QAAQ,GAAG,MAAMvB,YAAY,CACjCC,UAAU,CAACiB,OAAO,EAAEP,GAAG,EAAE;UAAEF;QAAU,CAAC,CAAC,EACvCQ,KAAK,EACL,MAAM,EACNL,IAAI,EACJO,OACF,CAAC;QACD,MAAMK,IAAI,GAAG,MAAMD,QAAQ,CAACC,IAAI,CAAC,CAAC;QAClC,MAAMC,OAAO,GAAGC,GAAG,CAACC,eAAe,CAACH,IAAI,CAAC;QAEzC,IAAIV,WAAW,CAACc,OAAO,EAAE;UACvBd,WAAW,CAACc,OAAO,CAACC,IAAI,GAAGJ,OAAO;UAClCX,WAAW,CAACc,OAAO,CAACE,QAAQ,GAAI,GAAEpB,QAAS,MAAK;UAChDI,WAAW,CAACc,OAAO,CAACG,KAAK,CAAC,CAAC;QAC7B;QAEAf,WAAW,CAAC,KAAK,CAAC;MACpB,CAAC,CAAC,OAAOgB,KAAU,EAAE;QACnBhB,WAAW,CAAC,KAAK,CAAC;QAClBZ,KAAK,CAAC4B,KAAK,CAACA,KAAK,CAACC,OAAO,CAAC;MAC5B;IACF;EACF,CAAC;EAED,oBACE1B,OAAA,CAACV,QAAQ;IAAAqC,QAAA,gBACP3B,OAAA;MAAG4B,GAAG,EAAErB,WAAY;MAACsB,SAAS,EAAC;IAAc;MAAA1B,QAAA,EAAA2B,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAEhDhC,OAAA,CAACR,YAAY;MACXyC,cAAc;MACdC,IAAI,EAAC,QAAQ;MACbC,WAAW,EAAEpB,cAAe;MAC5BqB,UAAU,EAAC,UAAU;MACrBC,OAAO,EAAE7B,QAAS;MAClB8B,aAAa,EAAE,2BAA4B;MAC3CC,QAAQ,EAAE,CAACpC;IAAS;MAAAA,QAAA,EAAA2B,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACrB,CAAC;EAAA;IAAA7B,QAAA,EAAA2B,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACM,CAAC;AAEf,CAAC;AAAC1B,EAAA,CAzDIL,YAAyC;EAAA,QAS/BH,WAAW,EACTA,WAAW;AAAA;AAAA0C,EAAA,GAVvBvC,YAAyC;AA2D/C,eAAeA,YAAY;AAAC,IAAAuC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}